/*! For license information please see 297.975f05b249f531f6.js.LICENSE.txt */
(self.webpackChunkpos_documents=self.webpackChunkpos_documents||[]).push([[297],{9297:(e,t,n)=>{n.r(t),n.d(t,{default:()=>p,useDocumentDetailsOptions:()=>m});var o=n(1921),r=n(6021),s=n(9619),a=n(3501),l=n(1521),i=n(5785),c=n(5912),d=n(2322);const u=({apiKey:e})=>{const{id:t}=(0,l.useParams)(),[n,u]=(0,o.useIonLoading)(),p=(0,s.useRef)(),m=(0,a.useQuery)(["document",t],(()=>i.Nl(e,t)),{staleTime:6e4});if(m.isSuccess&&(p.current=m.data.type),m.isLoading)return(0,d.jsx)(d.Fragment,{});if(m.isError)return(0,d.jsx)(o.IonList,{children:(0,d.jsx)(o.IonItem,{children:(0,d.jsx)(o.IonLabel,{children:(0,d.jsx)(o.IonText,{className:"ion-padding",children:"Something went wrong..."})})})});const h=e=>{n({message:e})};return(0,d.jsxs)(o.IonList,{lines:"full",className:"ion-no-padding",children:[c.Ry(p.current,"edit")?(0,d.jsxs)(o.IonItem,{className:"FS",button:!0,detail:!0,children:[(0,d.jsx)(o.IonIcon,{icon:r.create,slot:"start"}),(0,d.jsx)(o.IonLabel,{children:(0,d.jsx)("h3",{children:"Editar"})})]}):null,c.Ry(p.current,"print")?(0,d.jsxs)(o.IonItem,{className:"FT",button:!0,detail:!0,onClick:()=>{h("A imprimir..."),setTimeout((()=>u()),3e3)},children:[(0,d.jsx)(o.IonIcon,{icon:r.printSharp,slot:"start"}),(0,d.jsx)(o.IonLabel,{children:(0,d.jsx)("h3",{children:"Imprimir"})})]}):null,c.Ry(p.current,"sendEmail")?(0,d.jsxs)(o.IonItem,{className:"NH",button:!0,detail:!0,onClick:()=>{h("A Enviar Email..."),setTimeout((()=>u()),3e3)},children:[(0,d.jsx)(o.IonIcon,{icon:r.mailSharp,slot:"start"}),(0,d.jsx)(o.IonLabel,{children:(0,d.jsx)("h3",{children:"Enviar por E-mail"})})]}):null,c.Ry(p.current,"cancel")?(0,d.jsxs)(o.IonItem,{className:"RG",button:!0,detail:!0,children:[(0,d.jsx)(o.IonIcon,{icon:r.close,slot:"start"}),(0,d.jsx)(o.IonLabel,{children:(0,d.jsx)("h3",{children:"Anular"})})]}):null,c.Ry(p.current,"creditNote")?(0,d.jsxs)(o.IonItem,{className:"NC",button:!0,detail:!0,children:[(0,d.jsx)(o.IonIcon,{icon:r.documentTextSharp,slot:"start"}),(0,d.jsx)(o.IonLabel,{children:(0,d.jsx)("h3",{children:"Nota de Crédito"})})]}):null,c.Ry(p.current,"createTransport")?(0,d.jsxs)(o.IonItem,{className:"FS",button:!0,detail:!0,children:[(0,d.jsx)(o.IonIcon,{icon:r.carSharp,slot:"start"}),(0,d.jsx)(o.IonLabel,{children:(0,d.jsx)("h3",{children:"Criar Transporte"})})]}):null,c.Ry(p.current,"offerCoupon")?(0,d.jsxs)(o.IonItem,{className:"FR",button:!0,detail:!0,children:[(0,d.jsx)(o.IonIcon,{icon:r.giftSharp,slot:"start"}),(0,d.jsx)(o.IonLabel,{children:(0,d.jsx)("h3",{children:"Talão de Oferta"})})]}):null,c.Ry(p.current,"copyToSale")?(0,d.jsxs)(o.IonItem,{className:"RC",button:!0,detail:!0,children:[(0,d.jsx)(o.IonIcon,{icon:r.copySharp,slot:"start"}),(0,d.jsx)(o.IonLabel,{children:(0,d.jsx)("h3",{children:"Copiar para a venda"})})]}):null,c.Ry(p.current,"downloadPdf")?(0,d.jsxs)(o.IonItem,{className:"GO",button:!0,detail:!0,onClick:()=>{h("Downloading PDF..."),i.jG(e,t,m.data.number,u)},children:[(0,d.jsx)(o.IonIcon,{icon:r.documentSharp,slot:"start"}),(0,d.jsx)(o.IonLabel,{children:(0,d.jsx)("h3",{children:"Download PDF"})})]}):null,c.Ry(p.current,"registerPayment")?(0,d.jsxs)(o.IonItem,{button:!0,detail:!0,children:[(0,d.jsx)(o.IonIcon,{icon:r.logoEuro,slot:"start"}),(0,d.jsx)(o.IonLabel,{children:(0,d.jsx)("h3",{children:"Registrar Pagamento"})})]}):null]})},p=u,m=e=>({details:u({apiKey:e})})},5785:(e,t,n)=>{n.d(t,{Nl:()=>a,Pq:()=>s,jG:()=>l});var o=n(7786);let r="http://vendus-pt/ws/v1.2/documents/";r="https://www.vendus.pt/ws/v1.2/documents/";const s=async(e,t=1,n,s="")=>{const a=n.join(",");let l;const i={url:`${r}`,params:{api_key:e,envelope:"1",page:t.toString(),type:a,q:s}};return await o.CapacitorHttp.get(i).then((e=>l=e.data)).catch((e=>Promise.reject(new Error(e)))),l},a=async(e,t)=>{let n;const s={url:`${r}${t}`,params:{api_key:e}};return await o.CapacitorHttp.get(s).then((e=>n=e.data)).catch((e=>Promise.reject(new Error(e)))),n},l=async(e,t,n,s)=>{const a={url:`${r}${t}.pdf`,responseType:"blob",params:{api_key:e}};await o.CapacitorHttp.get(a).then((e=>{console.log("response from download: ",e);const t=new Blob([e.data],{type:"application/pdf"}),o=URL.createObjectURL(t),r=document.createElement("a");r.href=o,r.download=`${n}.pdf`,document.body.appendChild(r),r.click(),document.body.removeChild(r),s()})).catch((e=>(s(),Promise.reject(new Error(e))))),s()}},5912:(e,t,n)=>{n.d(t,{Ry:()=>d,sR:()=>l,su:()=>o,zh:()=>i});const o=(e,t)=>{const n=e;return-1===n.indexOf(t)?n.push(t):n.splice(n.indexOf(t),1),n},r=[{title:"Produto",size:"5"},{title:"Preço/Uni.",end:!0},{title:"Qtd.",end:!0},{title:"Preço",end:!0}],s=[{title:"Documento",size:"6"},{title:"Faturado",end:!0},{title:"Pago",end:!0}],a=[{title:"Produto",size:"5"},{title:"Stock"},{title:"Qtd."},{title:"Preço/Uni."},{title:"Preço",end:!0}],l=e=>["FT","DC","FR","GT","GA","GR","GD","EC","PF","OT","FS"].includes(e)?r:["RG"].includes(e)?s:["NC"].includes(e)?a:[],i=(e,t)=>["FT","DC","FR","GT","GA","GR","GD","EC","PF","OT","FS"].includes(e)?t.map((e=>({title:e.title,net_unit:e.amounts.net_unit,qty:e.qty,price:e.amounts.net_total}))):["NC"].includes(e)?t.map((e=>({title:e.title,stock:e.stock_control,qty:e.qty,net_unit:e.amounts.net_unit,price:e.amounts.net_total}))):["RG"].includes(e)?t.map((e=>({title:e.title,net_unit:e.amounts.net_total,gross_total:e.amounts.gross_total}))):[],c={print:["FT","DC","FR","GT","GA","GR","GD","EC","PF","OT","FS","NC","RG"],sendEmail:["FT","DC","FR","GT","GA","GR","GD","EC","PF","OT","FS","NC","RG"],creditNote:["FT","FR","FS"],createTransport:["FT","FR","FS"],offerCoupon:["FT","FR","FS"],copyToSale:["FT","DC","FR","GT","GA","GR","GD","EC","PF","OT","FS"],downloadPdf:["FT","DC","FR","GT","GA","GR","GD","EC","PF","OT","FS","NC","RG"],registerPayment:[],edit:["GT","GA","GR","GD"],cancel:["GT","GA","GR","GD","EC","PF","OT","NC","RG"]},d=(e,t)=>!!c[`${t}`].includes(e)},1837:(e,t,n)=>{var o=n(9619),r=Symbol.for("react.element"),s=Symbol.for("react.fragment"),a=Object.prototype.hasOwnProperty,l=o.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,i={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,n){var o,s={},c=null,d=null;for(o in void 0!==n&&(c=""+n),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(d=t.ref),t)a.call(t,o)&&!i.hasOwnProperty(o)&&(s[o]=t[o]);if(e&&e.defaultProps)for(o in t=e.defaultProps)void 0===s[o]&&(s[o]=t[o]);return{$$typeof:r,type:e,key:c,ref:d,props:s,_owner:l.current}}t.Fragment=s,t.jsx=c,t.jsxs=c},2322:(e,t,n)=>{e.exports=n(1837)}}]);